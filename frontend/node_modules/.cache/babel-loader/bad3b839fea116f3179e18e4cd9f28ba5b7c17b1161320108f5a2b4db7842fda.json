{"ast":null,"code":"import{createSlice,createAsyncThunk}from'@reduxjs/toolkit';import api from'../../api/index.api';export const signIn=createAsyncThunk('auth/signIn',async(payload,_ref)=>{let{rejectWithValue}=_ref;try{const res=await api.post('/auth/signin',payload);return res.data;}catch(err){var _err$response;return rejectWithValue(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||{message:'Network error'});}});export const signUp=createAsyncThunk('auth/signUp',async(payload,_ref2)=>{let{rejectWithValue}=_ref2;try{const res=await api.post('/auth/signup',payload);return res.data;}catch(err){var _err$response2;return rejectWithValue(((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.data)||{message:'Network error'});}});const initialToken=localStorage.getItem('token');const initialUser=localStorage.getItem('user')?JSON.parse(localStorage.getItem('user')):null;const authSlice=createSlice({name:'auth',initialState:{token:initialToken,user:initialUser,loading:false,error:null},reducers:{logout(state){state.token=null;state.user=null;localStorage.removeItem('token');localStorage.removeItem('user');},setCredits(state,action){if(state.user)state.user.credits=action.payload;}},extraReducers:builder=>{builder.addCase(signIn.pending,state=>{state.loading=true;state.error=null;}).addCase(signIn.fulfilled,(state,action)=>{state.loading=false;state.token=action.payload.token;state.user={id:action.payload.user.id,username:action.payload.user.username,email:action.payload.user.email,credits:action.payload.user.credits};localStorage.setItem('token',action.payload.token);localStorage.setItem('user',JSON.stringify(state.user));}).addCase(signIn.rejected,(state,action)=>{var _action$payload;state.loading=false;state.error=((_action$payload=action.payload)===null||_action$payload===void 0?void 0:_action$payload.message)||'Sign in failed';}).addCase(signUp.pending,state=>{state.loading=true;state.error=null;}).addCase(signUp.fulfilled,(state,action)=>{state.loading=false;state.token=action.payload.token;state.user={id:action.payload.user.id,username:action.payload.user.username,email:action.payload.user.email,credits:action.payload.user.credits};localStorage.setItem('token',action.payload.token);localStorage.setItem('user',JSON.stringify(state.user));}).addCase(signUp.rejected,(state,action)=>{var _action$payload2;state.loading=false;state.error=((_action$payload2=action.payload)===null||_action$payload2===void 0?void 0:_action$payload2.message)||'Sign up failed';});}});export const{logout,setCredits}=authSlice.actions;export default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","signIn","payload","_ref","rejectWithValue","res","post","data","err","_err$response","response","message","signUp","_ref2","_err$response2","initialToken","localStorage","getItem","initialUser","JSON","parse","authSlice","name","initialState","token","user","loading","error","reducers","logout","state","removeItem","setCredits","action","credits","extraReducers","builder","addCase","pending","fulfilled","id","username","email","setItem","stringify","rejected","_action$payload","_action$payload2","actions","reducer"],"sources":["C:/Users/Shashan/Videos/truegradient - 2 Assignment/frontend/src/features/auth/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport api from '../../api/index.api';\r\n\r\n\r\nexport const signIn = createAsyncThunk(\r\n  'auth/signIn',\r\n  async (payload, { rejectWithValue }) => {    \r\n    try {\r\n      const res = await api.post('/auth/signin', payload);\r\n      return res.data; \r\n    } catch (err) {\r\n      return rejectWithValue(err.response?.data || { message: 'Network error' });\r\n    }\r\n  }\r\n);\r\n\r\nexport const signUp = createAsyncThunk(\r\n  'auth/signUp',\r\n  async (payload, { rejectWithValue }) => {\r\n    try {\r\n      const res = await api.post('/auth/signup', payload);\r\n      return res.data; \r\n    } catch (err) {\r\n      return rejectWithValue(err.response?.data || { message: 'Network error' });\r\n    }\r\n  }\r\n);\r\n\r\nconst initialToken = localStorage.getItem('token');\r\nconst initialUser = localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null;\r\n\r\nconst authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState: { token: initialToken, user: initialUser, loading: false, error: null },\r\n  reducers: {\r\n    logout(state) {\r\n      state.token = null;\r\n      state.user = null;\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('user');\r\n    },\r\n    setCredits(state, action) {\r\n      if (state.user) state.user.credits = action.payload;\r\n    }\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n    \r\n      .addCase(signIn.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(signIn.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.token = action.payload.token;\r\n        state.user = {\r\n          id: action.payload.user.id,\r\n          username: action.payload.user.username,\r\n          email: action.payload.user.email,\r\n          credits: action.payload.user.credits\r\n        };\r\n        localStorage.setItem('token', action.payload.token);\r\n        localStorage.setItem('user', JSON.stringify(state.user));\r\n      })\r\n      .addCase(signIn.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload?.message || 'Sign in failed';\r\n      })\r\n\r\n    \r\n      .addCase(signUp.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(signUp.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.token = action.payload.token;\r\n        state.user = {\r\n          id: action.payload.user.id,\r\n          username: action.payload.user.username,\r\n          email: action.payload.user.email,\r\n          credits: action.payload.user.credits\r\n        };\r\n        localStorage.setItem('token', action.payload.token);\r\n        localStorage.setItem('user', JSON.stringify(state.user));\r\n      })\r\n      .addCase(signUp.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload?.message || 'Sign up failed';\r\n      });\r\n  }\r\n});\r\n\r\nexport const { logout, setCredits } = authSlice.actions;\r\nexport default authSlice.reducer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}